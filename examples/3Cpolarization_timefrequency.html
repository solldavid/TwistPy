
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3-C Polarization analysis and filtering in the time-frequency domain &#8212; TwistPy</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <link rel="canonical" href="https://twistpy.org/examples/3Cpolarization_timefrequency.html" />
    <link rel="shortcut icon" href="../_static/twistpy.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3-C Polarization analysis and filtering: Real data example using a marsquake recorded by InSight" href="marsquake.html" />
    <link rel="prev" title="3-C Polarization analysis and filtering in the time domain" href="3Cpolarization.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo_textbelow_oneaxis_adobe.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Instructions:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../installation.html">
   Installation Instructions
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Examples
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="3Cpolarization.html">
     3-C Polarization analysis and filtering in the time domain
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     3-C Polarization analysis and filtering in the time-frequency domain
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="marsquake.html">
     3-C Polarization analysis and filtering: Real data example using a marsquake recorded by InSight
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="six_component_wave_parameter_estimation.html">
     6-C Polarization Analysis: Time-domain wave parameter estimation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="alaska_wave_parameter_estimation.html">
     6-C Wave parameter estimation: gulf of alaska earthquake
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ml_wave_type_estimation.html">
     6-C wave type fingerprinting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="beamforming.html">
     Array Processing: Beamforming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="stransform.html">
     S-transform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dispersion.html">
     Six-component dispersion analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tilt.html">
     Tilt correction
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributing.html">
   Contributing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference documentation:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api/index.html">
   TwistPy API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis3C.html">
     twistpy.polarization.TimeDomainAnalysis3C
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis3C.filter.html">
       twistpy.polarization.TimeDomainAnalysis3C.filter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis3C.plot.html">
       twistpy.polarization.TimeDomainAnalysis3C.plot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis3C.polarization_analysis.html">
       twistpy.polarization.TimeDomainAnalysis3C.polarization_analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis3C.save.html">
       twistpy.polarization.TimeDomainAnalysis3C.save
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis3C.html">
     twistpy.polarization.TimeFrequencyAnalysis3C
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis3C.filter.html">
       twistpy.polarization.TimeFrequencyAnalysis3C.filter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis3C.plot.html">
       twistpy.polarization.TimeFrequencyAnalysis3C.plot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis3C.polarization_analysis.html">
       twistpy.polarization.TimeFrequencyAnalysis3C.polarization_analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis3C.save.html">
       twistpy.polarization.TimeFrequencyAnalysis3C.save
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.PolarizationModel3C.html">
     twistpy.polarization.PolarizationModel3C
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.PolarizationModel3C.polarization_vector.html">
       twistpy.polarization.PolarizationModel3C.polarization_vector
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.DispersionAnalysis.html">
     twistpy.polarization.DispersionAnalysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.DispersionAnalysis.plot.html">
       twistpy.polarization.DispersionAnalysis.plot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.DispersionAnalysis.plot_baz.html">
       twistpy.polarization.DispersionAnalysis.plot_baz
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.DispersionAnalysis.save.html">
       twistpy.polarization.DispersionAnalysis.save
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis6C.html">
     twistpy.polarization.TimeDomainAnalysis6C
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis6C.classify.html">
       twistpy.polarization.TimeDomainAnalysis6C.classify
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis6C.plot.html">
       twistpy.polarization.TimeDomainAnalysis6C.plot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis6C.polarization_analysis.html">
       twistpy.polarization.TimeDomainAnalysis6C.polarization_analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis6C.save.html">
       twistpy.polarization.TimeDomainAnalysis6C.save
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.html">
     twistpy.polarization.TimeFrequencyAnalysis6C
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.classify.html">
       twistpy.polarization.TimeFrequencyAnalysis6C.classify
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.filter.html">
       twistpy.polarization.TimeFrequencyAnalysis6C.filter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.plot_classification.html">
       twistpy.polarization.TimeFrequencyAnalysis6C.plot_classification
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.plot_wave_parameters.html">
       twistpy.polarization.TimeFrequencyAnalysis6C.plot_wave_parameters
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.polarization_analysis.html">
       twistpy.polarization.TimeFrequencyAnalysis6C.polarization_analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.save.html">
       twistpy.polarization.TimeFrequencyAnalysis6C.save
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.EstimatorConfiguration.html">
     twistpy.polarization.EstimatorConfiguration
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.EstimatorConfiguration.compute_steering_vectors.html">
       twistpy.polarization.EstimatorConfiguration.compute_steering_vectors
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.SupportVectorMachine.html">
     twistpy.polarization.SupportVectorMachine
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.SupportVectorMachine.load_model.html">
       twistpy.polarization.SupportVectorMachine.load_model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.SupportVectorMachine.train.html">
       twistpy.polarization.SupportVectorMachine.train
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.PolarizationModel6C.html">
     twistpy.polarization.PolarizationModel6C
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.PolarizationModel6C.polarization_vector.html">
       twistpy.polarization.PolarizationModel6C.polarization_vector
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/generated/twistpy.tilt.correction.remove_tilt.html">
     twistpy.tilt.correction.remove_tilt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/generated/twistpy.tilt.correction.transfer_function.html">
     twistpy.tilt.correction.transfer_function
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.array_processing.BeamformingArray.html">
     twistpy.array_processing.BeamformingArray
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.array_processing.BeamformingArray.add_data.html">
       twistpy.array_processing.BeamformingArray.add_data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.array_processing.BeamformingArray.beamforming.html">
       twistpy.array_processing.BeamformingArray.beamforming
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.array_processing.BeamformingArray.compute_steering_vectors.html">
       twistpy.array_processing.BeamformingArray.compute_steering_vectors
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/generated/twistpy.utils.stransform.html">
     twistpy.utils.stransform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/generated/twistpy.utils.istransform.html">
     twistpy.utils.istransform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/generated/twistpy.utils.load_analysis.html">
     twistpy.utils.load_analysis
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   Relevant Publications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributors.html">
   Contributors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contact.html">
   Contact
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../acknowledgments.html">
   Acknowledgments
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/examples/3Cpolarization_timefrequency.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/solldavid/TwistPy"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>3-C Polarization analysis and filtering in the time-frequency domain</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-3cpolarization-timefrequency-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="c-polarization-analysis-and-filtering-in-the-time-frequency-domain">
<span id="sphx-glr-examples-3cpolarization-timefrequency-py"></span><h1>3-C Polarization analysis and filtering in the time-frequency domain<a class="headerlink" href="#c-polarization-analysis-and-filtering-in-the-time-frequency-domain" title="Permalink to this headline">¶</a></h1>
<p>In this example, you will learn how to use TwistPy to perform a three-component polarization analysis in the
time-frequency domain. The time-frequency representation of the signal is obtained via the S-tranform
(<code class="xref py py-func docutils literal notranslate"><span class="pre">twistpy.utils.s_transform</span></code>). You will learn how to estimate polarization attributes such as the ellipticity,
the degree of polarization, and the directionality of the particle motion as a function of time and frequency and how
to use those attributes to filter the time series.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">obspy.core</span> <span class="kn">import</span> <span class="n">Trace</span><span class="p">,</span> <span class="n">Stream</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.hilbert.html#scipy.signal.hilbert" title="scipy.signal.hilbert" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">hilbert</span></a><span class="p">,</span> <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.convolve.html#scipy.signal.convolve" title="scipy.signal.convolve" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">convolve</span></a>

<span class="kn">from</span> <span class="nn">twistpy.convenience</span> <span class="kn">import</span> <span class="n">ricker</span>
<span class="kn">from</span> <span class="nn">twistpy.polarization</span> <span class="kn">import</span> <a href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis3C.html#twistpy.polarization.TimeFrequencyAnalysis3C" title="twistpy.polarization.TimeFrequencyAnalysis3C" class="sphx-glr-backref-module-twistpy-polarization sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">TimeFrequencyAnalysis3C</span></a><span class="p">,</span> <a href="../api/generated/twistpy.polarization.PolarizationModel3C.html#twistpy.polarization.PolarizationModel3C" title="twistpy.polarization.PolarizationModel3C" class="sphx-glr-backref-module-twistpy-polarization sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PolarizationModel3C</span></a>
<span class="kn">from</span> <span class="nn">twistpy.utils</span> <span class="kn">import</span> <a href="../api/generated/twistpy.utils.stransform.html#twistpy.utils.stransform" title="twistpy.utils.stransform" class="sphx-glr-backref-module-twistpy-utils sphx-glr-backref-type-py-function"><span class="n">stransform</span></a><span class="p">,</span> <a href="../api/generated/twistpy.utils.load_analysis.html#twistpy.utils.load_analysis" title="twistpy.utils.load_analysis" class="sphx-glr-backref-module-twistpy-utils sphx-glr-backref-type-py-function"><span class="n">load_analysis</span></a>

<span class="n">rng</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/random/generator.html#numpy.random.default_rng" title="numpy.random.default_rng" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span></a><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># sphinx_gallery_thumbnail_number = 2</span>
</pre></div>
</div>
<p>We start by generating a very simple synthetic data set for illustration purposes. The data will contain isolated wave
arrivals for a P-wave, an SV-wave, an SH wave, a Love-wave, and a Rayleigh wave. To generate the data, we make use
of the pure state polarization models that are implemented in the class ‘twistpy.polarization.PolarizationModel3C’.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate an empty time series for each wave</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">270</span>  <span class="c1"># Number of samples in the time series</span>
<span class="n">signal1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># Each signal has three components</span>
<span class="n">signal2</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">signal3</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">signal4</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">signal5</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">dt</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">250.0</span>  <span class="c1"># sampling interval</span>
<span class="n">t</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">signal1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="n">dt</span>  <span class="c1"># time axis</span>
<span class="n">wavelet</span><span class="p">,</span> <span class="n">t_wav</span><span class="p">,</span> <span class="n">wcenter</span> <span class="o">=</span> <span class="n">ricker</span><span class="p">(</span>
    <span class="n">t</span><span class="p">,</span> <span class="mf">30.0</span>
<span class="p">)</span>  <span class="c1"># generate a Ricker wavelet with 30 Hz center frequency</span>
<span class="n">wavelet</span> <span class="o">=</span> <span class="n">wavelet</span><span class="p">[</span><span class="n">wcenter</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="p">:</span> <span class="n">wcenter</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span>
<span class="n">wavelet_hilb</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.imag.html#numpy.imag" title="numpy.imag" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">imag</span></a><span class="p">(</span>
    <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.hilbert.html#scipy.signal.hilbert" title="scipy.signal.hilbert" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">hilbert</span></a><span class="p">(</span><span class="n">wavelet</span><span class="p">)</span>
<span class="p">)</span>  <span class="c1"># Here we make use of the Hilbert transform to generate a Ricker wavelet</span>
<span class="c1"># with a 90 degree phase shift. This is to account for the fact that, for Rayleigh waves, the horizontal components are</span>
<span class="c1"># phase-shifted by 90 degrees with respect to the other components.</span>
</pre></div>
</div>
<p>We now generate the relative amplitudes with which the waves are recorded on the three-component seismometer. All
waves will arrive with a propagation azimuth of 30 degrees (ecxept for the P-wave, which we specify to have an azimuth
of 60 degrees), the body waves will have an inclination angle of 20 degrees. The
local P-wave and S-wave velocities at the recording station are assumed to be 1000 m/s and 400 m/s, respectively. The
Rayleigh wave ellipticity angle is set to be -45 degrees resulting in a circular polarization.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wave1</span> <span class="o">=</span> <a href="../api/generated/twistpy.polarization.PolarizationModel3C.html#twistpy.polarization.PolarizationModel3C" title="twistpy.polarization.PolarizationModel3C" class="sphx-glr-backref-module-twistpy-polarization sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PolarizationModel3C</span></a><span class="p">(</span>
    <span class="n">wave_type</span><span class="o">=</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">vp</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span> <span class="n">vs</span><span class="o">=</span><span class="mf">400.0</span><span class="p">,</span> <span class="n">free_surface</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="c1"># Generate a P-wave polarization model for</span>
<span class="c1"># a P-wave recorded at the free surface with an inclination of 20 degrees, an azimuth of 60 degrees. The local P- and</span>
<span class="c1"># S-wave velocities are 1000 m/s and 400 m/s</span>
<span class="n">wave2</span> <span class="o">=</span> <a href="../api/generated/twistpy.polarization.PolarizationModel3C.html#twistpy.polarization.PolarizationModel3C" title="twistpy.polarization.PolarizationModel3C" class="sphx-glr-backref-module-twistpy-polarization sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PolarizationModel3C</span></a><span class="p">(</span>
    <span class="n">wave_type</span><span class="o">=</span><span class="s2">&quot;SV&quot;</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">vp</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span> <span class="n">vs</span><span class="o">=</span><span class="mf">400.0</span><span class="p">,</span> <span class="n">free_surface</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>  <span class="c1"># Generate an SV-wave polarization model</span>
<span class="n">wave3</span> <span class="o">=</span> <a href="../api/generated/twistpy.polarization.PolarizationModel3C.html#twistpy.polarization.PolarizationModel3C" title="twistpy.polarization.PolarizationModel3C" class="sphx-glr-backref-module-twistpy-polarization sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PolarizationModel3C</span></a><span class="p">(</span><span class="n">wave_type</span><span class="o">=</span><span class="s2">&quot;SH&quot;</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">free_surface</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Generate an SH-wave polarization model</span>
<span class="n">wave4</span> <span class="o">=</span> <a href="../api/generated/twistpy.polarization.PolarizationModel3C.html#twistpy.polarization.PolarizationModel3C" title="twistpy.polarization.PolarizationModel3C" class="sphx-glr-backref-module-twistpy-polarization sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PolarizationModel3C</span></a><span class="p">(</span>
    <span class="n">wave_type</span><span class="o">=</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mf">30.0</span>
<span class="p">)</span>  <span class="c1"># Generate a Love-wave polarization model</span>
<span class="n">wave5</span> <span class="o">=</span> <a href="../api/generated/twistpy.polarization.PolarizationModel3C.html#twistpy.polarization.PolarizationModel3C" title="twistpy.polarization.PolarizationModel3C" class="sphx-glr-backref-module-twistpy-polarization sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PolarizationModel3C</span></a><span class="p">(</span>
    <span class="n">wave_type</span><span class="o">=</span><span class="s2">&quot;R&quot;</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">xi</span><span class="o">=-</span><span class="mf">45.0</span>
<span class="p">)</span>  <span class="c1"># Generate a Rayleigh-wave polarization model with a</span>
<span class="c1"># Rayleigh wave ellipticity angle of -45 degrees.</span>
</pre></div>
</div>
<p>Now we populate our signal with the computed amplitudes by setting a spike with the respective amplitude onto the
different locations of the time axis. Then we convolve the data with the Ricker wavelet to generate our synthetic
test seismograms.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">signal1</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">wave1</span><span class="o">.</span><span class="n">polarization</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">T</span>
<span class="n">signal2</span><span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">wave2</span><span class="o">.</span><span class="n">polarization</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">T</span>
<span class="n">signal3</span><span class="p">[</span><span class="mi">130</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">wave3</span><span class="o">.</span><span class="n">polarization</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">T</span>
<span class="n">signal4</span><span class="p">[</span><span class="mi">180</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">wave4</span><span class="o">.</span><span class="n">polarization</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">T</span>
<span class="n">signal5</span><span class="p">[</span><span class="mi">230</span><span class="p">,</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.real.html#numpy.real" title="numpy.real" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">real</span></a><span class="p">(</span><span class="n">wave5</span><span class="o">.</span><span class="n">polarization</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">signal5</span><span class="p">[</span><span class="mi">230</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.imag.html#numpy.imag" title="numpy.imag" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">imag</span></a><span class="p">(</span><span class="n">wave5</span><span class="o">.</span><span class="n">polarization</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">signal1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">signal1</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.convolve.html#scipy.signal.convolve" title="scipy.signal.convolve" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">convolve</span></a><span class="p">(</span><span class="n">signal1</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
    <span class="n">signal2</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.convolve.html#scipy.signal.convolve" title="scipy.signal.convolve" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">convolve</span></a><span class="p">(</span><span class="n">signal2</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
    <span class="n">signal3</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.convolve.html#scipy.signal.convolve" title="scipy.signal.convolve" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">convolve</span></a><span class="p">(</span><span class="n">signal3</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
    <span class="n">signal4</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.convolve.html#scipy.signal.convolve" title="scipy.signal.convolve" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">convolve</span></a><span class="p">(</span><span class="n">signal4</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="p">):</span>  <span class="c1"># Special case for horizontal translational components of the Rayleigh wave</span>
        <span class="n">signal5</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.convolve.html#scipy.signal.convolve" title="scipy.signal.convolve" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">convolve</span></a><span class="p">(</span><span class="n">signal5</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">wavelet_hilb</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">signal5</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.convolve.html#scipy.signal.convolve" title="scipy.signal.convolve" class="sphx-glr-backref-module-scipy-signal sphx-glr-backref-type-py-function"><span class="n">convolve</span></a><span class="p">(</span><span class="n">signal5</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>

<span class="n">signal</span> <span class="o">=</span> <span class="n">signal1</span> <span class="o">+</span> <span class="n">signal2</span> <span class="o">+</span> <span class="n">signal3</span> <span class="o">+</span> <span class="n">signal4</span> <span class="o">+</span> <span class="n">signal5</span>  <span class="c1"># sum all signals together</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">signal</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

<span class="n">signal</span> <span class="o">+=</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">noise</span>
<span class="c1"># Plot the data</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;k:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;k--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;E&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Z&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.text.html#matplotlib.pyplot.text" title="matplotlib.pyplot.text" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">text</span></a><span class="p">((</span><span class="mi">30</span> <span class="o">-</span> <span class="mi">20</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s2">&quot;P-wave&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.text.html#matplotlib.pyplot.text" title="matplotlib.pyplot.text" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">text</span></a><span class="p">((</span><span class="mi">80</span> <span class="o">-</span> <span class="mi">20</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s2">&quot;SV-wave&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.text.html#matplotlib.pyplot.text" title="matplotlib.pyplot.text" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">text</span></a><span class="p">((</span><span class="mi">130</span> <span class="o">-</span> <span class="mi">20</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s2">&quot;SH-wave&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.text.html#matplotlib.pyplot.text" title="matplotlib.pyplot.text" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">text</span></a><span class="p">((</span><span class="mi">180</span> <span class="o">-</span> <span class="mi">20</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s2">&quot;Love-wave&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.text.html#matplotlib.pyplot.text" title="matplotlib.pyplot.text" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">text</span></a><span class="p">((</span><span class="mi">230</span> <span class="o">-</span> <span class="mi">20</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s2">&quot;Rayleigh-wave&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center left&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_3Cpolarization_timefrequency_001.png" srcset="../_images/sphx_glr_3Cpolarization_timefrequency_001.png" alt="3Cpolarization timefrequency" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 25.722222222222214, &#39;Time (s)&#39;)
</pre></div>
</div>
<p>To make the synthetics accessible to TwistPy, we convert them to an Obspy Stream object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">Trace</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">signal</span><span class="p">[:,</span> <span class="n">n</span><span class="p">],</span>
        <span class="n">header</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;delta&quot;</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;npts&quot;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;starttime&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">data</span> <span class="o">+=</span> <span class="n">trace</span>
</pre></div>
</div>
<p>We now have our toy data ready that we want to use for polarization analysis and filtering. First, we need to specify
the window parameters of the time-frequency window, within which the covariance matrices will be averaged. Here we
specify a window that is frequency-dependent and extends over a single period in time (1/frequency). In the
frequency-direction the window extends over 5 Hz.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">window</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;number_of_periods&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;frequency_extent&quot;</span><span class="p">:</span> <span class="mf">50.0</span><span class="p">}</span>
</pre></div>
</div>
<p>Now we set up the polarization analysis. We use a value of k=1 for the S-transform.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span> <span class="o">=</span> <a href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis3C.html#twistpy.polarization.TimeFrequencyAnalysis3C" title="twistpy.polarization.TimeFrequencyAnalysis3C" class="sphx-glr-backref-module-twistpy-polarization sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">TimeFrequencyAnalysis3C</span></a><span class="p">(</span>
    <span class="n">N</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">E</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Z</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span> <span class="n">timeaxis</span><span class="o">=</span><span class="s2">&quot;rel&quot;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing covariance matrices...
Covariance matrices computed!
</pre></div>
</div>
<p>To compute the polarization attributes, we run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">polarization_analysis</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing polarization attributes...
Polarization attributes have been computed!
</pre></div>
</div>
<p>To plot the result, we can make use of the plot() method. We want to plot the inclination and
azimuth of the major semi-axis of the polarization ellipse and only plot the polarization attributes at time frequency
points where the signal strength in all three-components exceeds 5 percent of the maximum value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">major_semi_axis</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_3Cpolarization_timefrequency_002.png" srcset="../_images/sphx_glr_3Cpolarization_timefrequency_002.png" alt="Ellipticity, Inclination of major semi-axis, Azimuth of major semi-axis, Degree of polarization" class = "sphx-glr-single-img"/><p>You can also plot the polarization attributes with a logarithmic frequency axis and restrict the frequency range that
is plotted (here we only plot results between 10 Hz and 100 Hz).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">major_semi_axis</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_frequency</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">100.</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_3Cpolarization_timefrequency_003.png" srcset="../_images/sphx_glr_3Cpolarization_timefrequency_003.png" alt="Ellipticity, Inclination of major semi-axis, Azimuth of major semi-axis, Degree of polarization" class = "sphx-glr-single-img"/><p>We can now use the computed polarization attributes to devise a polarization filter.
Depending on the number of samples in the seismograms, the computation of the polarization attributes can become quite
expensive. If you do not want to recompute the polarization attributes, everytime you try a new filter, consider
saving them to disk with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;my_analysis.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To reload your analysis from the disk, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span> <span class="o">=</span> <a href="../api/generated/twistpy.utils.load_analysis.html#twistpy.utils.load_analysis" title="twistpy.utils.load_analysis" class="sphx-glr-backref-module-twistpy-utils sphx-glr-backref-type-py-function"><span class="n">load_analysis</span></a><span class="p">(</span><span class="s2">&quot;my_analysis.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Once the polarization attributes are computed, you can access them as c lass attributes. The available attributes are:
‘dop’ (degree of polarization), ‘elli’ (Ellipticity), ‘inc1’ (Inclination of the major semi-axis of the polarization
ellipse), ‘inc2’ (Inclination of the minor semi-axis), ‘azi1’ (Azimuth of the major semi-axis), and ‘azi2’ (Azimuth of
the minor semi-axis). So, for example, if you want to access the ellipticity, you would do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">elli</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">elli</span>
</pre></div>
</div>
<p>The corresponding frequency and time axes are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">t_pol</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">f_pol</span>
</pre></div>
</div>
<p>Now, let us devise a simple polarization filter. For this, we make use of the filter() method.  The method takes
arbitrary polarization attributes as an input for filtering. For example, we can
devise a filter that will only keep the parts of the signal that are rectilinearly polarized (i.e., low ellipticity
below 0.2), show a high degree of polarization (larger than 0.7), and that have a predominantly vertical polarization
(inclination angle of the major semi-axis smaller than 40). The inclination is measured from the vertical axis
downward, meaning that a wave at completely vertical incidence has an inclination of 0 degrees.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_filtered</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">plot_filtered_attributes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">elli</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="n">dop</span><span class="o">=</span><span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">inc1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_3Cpolarization_timefrequency_004.png" srcset="../_images/sphx_glr_3Cpolarization_timefrequency_004.png" alt="Ellipticity, Inclination of major semi-axis, Azimuth of major semi-axis, Degree of polarization" class = "sphx-glr-single-img"/><p>If we have a look at the output of this filter both in the time-domain and in the S-transform, we will see that only
the P-wave is retained, while all other signals are suppressed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute S-transform of vertical component for plotting</span>
<span class="n">Z_stran</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <a href="../api/generated/twistpy.utils.stransform.html#twistpy.utils.stransform" title="twistpy.utils.stransform" class="sphx-glr-backref-module-twistpy-utils sphx-glr-backref-type-py-function"><span class="n">stransform</span></a><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Z_stran_filtered</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <a href="../api/generated/twistpy.utils.stransform.html#twistpy.utils.stransform" title="twistpy.utils.stransform" class="sphx-glr-backref-module-twistpy-utils sphx-glr-backref-type-py-function"><span class="n">stransform</span></a><span class="p">(</span>
    <span class="n">data_filtered</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>  <span class="c1"># S-transform of filtered data for comparison</span>
<span class="n">f</span> <span class="o">/=</span> <span class="n">dt</span>

<span class="c1"># Plot the result</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">analysis</span><span class="o">.</span><span class="n">t_pol</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Z-Component Input Data&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Z_stran</span><span class="p">),</span>
    <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span>
    <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">extent</span><span class="o">=</span><span class="p">[</span>
        <span class="n">analysis</span><span class="o">.</span><span class="n">t_pol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">analysis</span><span class="o">.</span><span class="n">t_pol</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">analysis</span><span class="o">.</span><span class="n">f_pol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">analysis</span><span class="o">.</span><span class="n">f_pol</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;S-transform Input Data&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">analysis</span><span class="o">.</span><span class="n">t_pol</span><span class="p">,</span> <span class="n">data_filtered</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Z-Component Filtered Data&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Z_stran_filtered</span><span class="p">),</span>
    <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span>
    <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">extent</span><span class="o">=</span><span class="p">[</span>
        <span class="n">analysis</span><span class="o">.</span><span class="n">t_pol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">analysis</span><span class="o">.</span><span class="n">t_pol</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">analysis</span><span class="o">.</span><span class="n">f_pol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">analysis</span><span class="o">.</span><span class="n">f_pol</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;S-transform Filtered Data&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_3Cpolarization_timefrequency_005.png" srcset="../_images/sphx_glr_3Cpolarization_timefrequency_005.png" alt="Z-Component Input Data, Z-Component Filtered Data, S-transform Input Data, S-transform Filtered Data" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;S-transform Filtered Data&#39;)
</pre></div>
</div>
<p>Similarly, we could devise a filter that only retains the elliptically polarized parts of the signal (e.g., surface
waves).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_filtered_rayleigh</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">plot_filtered_attributes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">elli</span><span class="o">=</span><span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">dop</span><span class="o">=</span><span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_3Cpolarization_timefrequency_006.png" srcset="../_images/sphx_glr_3Cpolarization_timefrequency_006.png" alt="Ellipticity, Inclination of major semi-axis, Azimuth of major semi-axis, Degree of polarization" class = "sphx-glr-single-img"/><p>To filter out parts of the signal that exhibit particle motion along a specific direction (e.g., an azimuth around 60
degrees), we could use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_filtered_60degrees_azimuth</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
    <span class="n">plot_filtered_attributes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">azi1</span><span class="o">=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">],</span> <span class="n">dop</span><span class="o">=</span><span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_3Cpolarization_timefrequency_007.png" srcset="../_images/sphx_glr_3Cpolarization_timefrequency_007.png" alt="Ellipticity, Inclination of major semi-axis, Azimuth of major semi-axis, Degree of polarization" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  3.254 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-3cpolarization-timefrequency-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/cc52704b46fb5c7a4ab0995aec8bbd32/3Cpolarization_timefrequency.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">3Cpolarization_timefrequency.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/57d18d3b731bb2fdd3feb21ae9bf60e7/3Cpolarization_timefrequency.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">3Cpolarization_timefrequency.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="3Cpolarization.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">3-C Polarization analysis and filtering in the time domain</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="marsquake.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">3-C Polarization analysis and filtering: Real data example using a marsquake recorded by InSight</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
        &copy; Copyright 2022, The TwistPy Developers.<br/>
      Last updated on Dec 19, 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-MYGG4BF95D"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MYGG4BF95D');
</script>

  </body>
</html>