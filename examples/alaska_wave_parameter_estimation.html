
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>6-C Wave parameter estimation: gulf of alaska earthquake &#8212; TwistPy</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <link rel="canonical" href="https://twistpy.org/examples/alaska_wave_parameter_estimation.html" />
    <link rel="shortcut icon" href="../_static/twistpy.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Array Processing: Beamforming" href="beamforming.html" />
    <link rel="prev" title="6-C Polarization Analysis: Wave type classification" href="ml_wave_type_estimation.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo_textbelow_oneaxis_adobe.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Instructions:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../installation.html">
   Installation Instructions
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Examples
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="3Cpolarization.html">
     3-C Polarization analysis and filtering in the time domain
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3Cpolarization_timefrequency.html">
     3-C Polarization analysis and filtering in the time-frequency domain
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="marsquake.html">
     3-C Polarization analysis and filtering: Real data example using a marsquake recorded by InSight
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="six_component_wave_parameter_estimation.html">
     6-C Polarization Analysis: Time-domain wave parameter estimation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ml_wave_type_estimation.html">
     6-C Polarization Analysis: Wave type classification
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6-C Wave parameter estimation: gulf of alaska earthquake
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="beamforming.html">
     Array Processing: Beamforming
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="stransform.html">
     S-transform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="dispersion.html">
     Six-component dispersion analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tilt.html">
     Tilt correction
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributing.html">
   Contributing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference documentation:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api/index.html">
   TwistPy API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis3C.html">
     twistpy.polarization.TimeDomainAnalysis3C
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis3C.filter.html">
       twistpy.polarization.TimeDomainAnalysis3C.filter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis3C.plot.html">
       twistpy.polarization.TimeDomainAnalysis3C.plot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis3C.polarization_analysis.html">
       twistpy.polarization.TimeDomainAnalysis3C.polarization_analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis3C.save.html">
       twistpy.polarization.TimeDomainAnalysis3C.save
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis3C.html">
     twistpy.polarization.TimeFrequencyAnalysis3C
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis3C.filter.html">
       twistpy.polarization.TimeFrequencyAnalysis3C.filter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis3C.plot.html">
       twistpy.polarization.TimeFrequencyAnalysis3C.plot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis3C.polarization_analysis.html">
       twistpy.polarization.TimeFrequencyAnalysis3C.polarization_analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis3C.save.html">
       twistpy.polarization.TimeFrequencyAnalysis3C.save
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.PolarizationModel3C.html">
     twistpy.polarization.PolarizationModel3C
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.PolarizationModel3C.polarization_vector.html">
       twistpy.polarization.PolarizationModel3C.polarization_vector
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.DispersionAnalysis.html">
     twistpy.polarization.DispersionAnalysis
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.DispersionAnalysis.plot.html">
       twistpy.polarization.DispersionAnalysis.plot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.DispersionAnalysis.plot_baz.html">
       twistpy.polarization.DispersionAnalysis.plot_baz
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.DispersionAnalysis.save.html">
       twistpy.polarization.DispersionAnalysis.save
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis6C.html">
     twistpy.polarization.TimeDomainAnalysis6C
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis6C.classify.html">
       twistpy.polarization.TimeDomainAnalysis6C.classify
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis6C.plot.html">
       twistpy.polarization.TimeDomainAnalysis6C.plot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis6C.polarization_analysis.html">
       twistpy.polarization.TimeDomainAnalysis6C.polarization_analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeDomainAnalysis6C.save.html">
       twistpy.polarization.TimeDomainAnalysis6C.save
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.html">
     twistpy.polarization.TimeFrequencyAnalysis6C
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.classify.html">
       twistpy.polarization.TimeFrequencyAnalysis6C.classify
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.filter.html">
       twistpy.polarization.TimeFrequencyAnalysis6C.filter
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.plot_classification.html">
       twistpy.polarization.TimeFrequencyAnalysis6C.plot_classification
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.plot_wave_parameters.html">
       twistpy.polarization.TimeFrequencyAnalysis6C.plot_wave_parameters
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.polarization_analysis.html">
       twistpy.polarization.TimeFrequencyAnalysis6C.polarization_analysis
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.save.html">
       twistpy.polarization.TimeFrequencyAnalysis6C.save
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.EstimatorConfiguration.html">
     twistpy.polarization.EstimatorConfiguration
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.EstimatorConfiguration.compute_steering_vectors.html">
       twistpy.polarization.EstimatorConfiguration.compute_steering_vectors
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.SupportVectorMachine.html">
     twistpy.polarization.SupportVectorMachine
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.SupportVectorMachine.load_model.html">
       twistpy.polarization.SupportVectorMachine.load_model
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.SupportVectorMachine.train.html">
       twistpy.polarization.SupportVectorMachine.train
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.polarization.PolarizationModel6C.html">
     twistpy.polarization.PolarizationModel6C
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.polarization.PolarizationModel6C.polarization_vector.html">
       twistpy.polarization.PolarizationModel6C.polarization_vector
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/generated/twistpy.tilt.correction.remove_tilt.html">
     twistpy.tilt.correction.remove_tilt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/generated/twistpy.tilt.correction.transfer_function.html">
     twistpy.tilt.correction.transfer_function
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/generated/twistpy.array_processing.BeamformingArray.html">
     twistpy.array_processing.BeamformingArray
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.array_processing.BeamformingArray.add_data.html">
       twistpy.array_processing.BeamformingArray.add_data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.array_processing.BeamformingArray.beamforming.html">
       twistpy.array_processing.BeamformingArray.beamforming
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/generated/twistpy.array_processing.BeamformingArray.compute_steering_vectors.html">
       twistpy.array_processing.BeamformingArray.compute_steering_vectors
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/generated/twistpy.utils.stransform.html">
     twistpy.utils.stransform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/generated/twistpy.utils.istransform.html">
     twistpy.utils.istransform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/generated/twistpy.utils.load_analysis.html">
     twistpy.utils.load_analysis
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../references.html">
   Relevant Publications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributors.html">
   Contributors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contact.html">
   Contact
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../acknowledgments.html">
   Acknowledgments
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/examples/alaska_wave_parameter_estimation.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/solldavid/TwistPy"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>6-C Wave parameter estimation: gulf of alaska earthquake</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-alaska-wave-parameter-estimation-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="c-wave-parameter-estimation-gulf-of-alaska-earthquake">
<span id="sphx-glr-examples-alaska-wave-parameter-estimation-py"></span><h1>6-C Wave parameter estimation: gulf of alaska earthquake<a class="headerlink" href="#c-wave-parameter-estimation-gulf-of-alaska-earthquake" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will teach you how to use TwistPy to process six component seismic data as recorded by collocated
translational and rotational seismometers. The data used in this tutorial was recorded at the large ring laser
observatory ROMY in Furstenfeldbruck, Germany after the January, 23rd 2018 M7.8 gulf of Alaska earthquake
(Occurence Time: 2018-01-23 09:31:40 UTC).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">obspy</span> <span class="kn">import</span> <span class="n">read</span>

<span class="kn">from</span> <span class="nn">twistpy.polarization</span> <span class="kn">import</span> <a href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.html#twistpy.polarization.TimeFrequencyAnalysis6C" title="twistpy.polarization.TimeFrequencyAnalysis6C" class="sphx-glr-backref-module-twistpy-polarization sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">TimeFrequencyAnalysis6C</span></a><span class="p">,</span> <a href="../api/generated/twistpy.polarization.EstimatorConfiguration.html#twistpy.polarization.EstimatorConfiguration" title="twistpy.polarization.EstimatorConfiguration" class="sphx-glr-backref-module-twistpy-polarization sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">EstimatorConfiguration</span></a>
</pre></div>
</div>
<p>We start by reading in the 6DOF data and apply some basic pre-processing to it using standard ObsPy functionality.
To ensure that the amplitudes of all six time series are on the same order of magnitude and have the same unit,
we apply a scaling velocity to the translational components:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s2">&quot;../example_data/ROMY_gulf_of_alaska_teleseism.mseed&quot;</span><span class="p">)</span>
<span class="n">scaling_velocity</span> <span class="o">=</span> <span class="mf">4500.0</span>

<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">trace</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">trace</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s2">&quot;spline&quot;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dspline</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">trace</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">starttime</span><span class="o">=</span><span class="n">trace</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="o">=</span><span class="n">trace</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span> <span class="o">-</span> <span class="mi">4500</span><span class="p">)</span>
    <span class="n">trace</span><span class="o">.</span><span class="n">taper</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">trace</span><span class="o">.</span><span class="n">data</span> <span class="o">/=</span> <span class="n">scaling_velocity</span>
</pre></div>
</div>
<p>Now we are ready to set up the 6DOF polarization analysis problem. The spectral matrices from which the polarization
attributes are estimated are computed in a time-frequency window. We choose the window to be frequency-dependent and
extend over 1 period (1/f) in the time direction and over 0.01 Hz in the frequency direction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">window</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;number_of_periods&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;frequency_extent&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">}</span>
</pre></div>
</div>
<p>Now we are ready to set up the 6DOF polarization analysis problem.  We want to perform the analysis in the
time-frequency domain, so we set up a TimeFrequencyAnalysis6C object and feed it our data and the polarization
analysis window. Additionally, we restrict the analysis to the frequency range between 0.01 and 0.15 Hz, where
we expect surface waves to dominate. To reduce the computational effort, we only compute wave paramters at every 20th
sample in time and in frequency:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span> <span class="o">=</span> <a href="../api/generated/twistpy.polarization.TimeFrequencyAnalysis6C.html#twistpy.polarization.TimeFrequencyAnalysis6C" title="twistpy.polarization.TimeFrequencyAnalysis6C" class="sphx-glr-backref-module-twistpy-polarization sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">TimeFrequencyAnalysis6C</span></a><span class="p">(</span>
    <span class="n">traN</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">traE</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">traZ</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">rotN</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
    <span class="n">rotE</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
    <span class="n">rotZ</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span>
    <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
    <span class="n">dsfacf</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">dsfact</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">frange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing covariance matrices...
Covariance matrices computed!
</pre></div>
</div>
<p>Now we set up an EstimaatorConfiguration, specifying for which wave types we want to estimate wave parameters (in
this example only Rayleigh waves), what kind of estimator we want to use, and the range of wave parameters that are
tested.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">est</span> <span class="o">=</span> <a href="../api/generated/twistpy.polarization.EstimatorConfiguration.html#twistpy.polarization.EstimatorConfiguration" title="twistpy.polarization.EstimatorConfiguration" class="sphx-glr-backref-module-twistpy-polarization sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">EstimatorConfiguration</span></a><span class="p">(</span>
    <span class="n">wave_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;R&quot;</span><span class="p">],</span>
    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;DOT&quot;</span><span class="p">,</span>
    <span class="n">scaling_velocity</span><span class="o">=</span><span class="n">scaling_velocity</span><span class="p">,</span>
    <span class="n">use_ml_classification</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">vr</span><span class="o">=</span><span class="p">[</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="n">xi</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="n">phi</span><span class="o">=</span><span class="p">[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">eigenvector</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Let’s start the analysis!</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">polarization_analysis</span><span class="p">(</span><span class="n">estimator_configuration</span><span class="o">=</span><span class="n">est</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing wave parameters...
Estimating wave parameters for R-Waves...
Done!
</pre></div>
</div>
<p>Once the wave parameters are computed, we can access them as a dictionary obtained from the attribute wave_parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">analysis</span><span class="o">.</span><span class="n">wave_parameters</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;P&#39;: {&#39;vp&#39;: None, &#39;vp_to_vs&#39;: None, &#39;theta&#39;: None, &#39;phi&#39;: None, &#39;lh&#39;: None}, &#39;SV&#39;: {&#39;vp&#39;: None, &#39;vp_to_vs&#39;: None, &#39;theta&#39;: None, &#39;phi&#39;: None, &#39;lh&#39;: None}, &#39;SH&#39;: {&#39;vs&#39;: None, &#39;theta&#39;: None, &#39;phi&#39;: None, &#39;lh&#39;: None}, &#39;R&#39;: {&#39;vr&#39;: array([[4000, 4000, 4000, ..., 4000, 4000, 4000],
       [3000, 3000, 3000, ..., 3900, 3800, 3900],
       [4000, 4000, 3000, ..., 4000, 4000, 4000],
       ...,
       [3500, 3000, 3000, ..., 3000, 3000, 3000],
       [3400, 3000, 3000, ..., 3000, 3000, 3000],
       [3500, 3000, 3000, ..., 3000, 3000, 4000]]), &#39;phi&#39;: array([[210, 210, 210, ..., 210, 210, 210],
       [150, 150, 150, ..., 174, 169, 157],
       [152, 157, 187, ..., 168, 162, 154],
       ...,
       [150, 150, 196, ..., 150, 151, 210],
       [150, 150, 193, ..., 150, 151, 210],
       [163, 150, 187, ..., 156, 154, 210]]), &#39;xi&#39;: array([[-52, -50, -50, ..., -54, -54, -54],
       [-32, -24, -12, ..., -20, -28, -30],
       [-72, -68, -28, ..., -76, -72, -68],
       ...,
       [-56, -16, -22, ..., -76, -84, -76],
       [-56, -12, -20, ..., -76, -84, -70],
       [-54, -10, -22, ..., -74, -82, -62]]), &#39;lh&#39;: array([[0.60708311, 0.58872218, 0.50825084, ..., 0.69386143, 0.69218305,
        0.6920553 ],
       [0.47834236, 0.45748968, 0.41683573, ..., 0.54862892, 0.54767244,
        0.52601953],
       [0.57445563, 0.59898155, 0.53772858, ..., 0.57399101, 0.58474929,
        0.58262612],
       ...,
       [0.53654438, 0.38803749, 0.35921063, ..., 0.46655726, 0.43623477,
        0.40777023],
       [0.5576458 , 0.37849171, 0.34852738, ..., 0.41553094, 0.45177927,
        0.43573336],
       [0.53368348, 0.37949115, 0.33713734, ..., 0.37192061, 0.46599798,
        0.45128402]])}, &#39;L&#39;: {&#39;vl&#39;: None, &#39;phi&#39;: None, &#39;lh&#39;: None}}
</pre></div>
</div>
<p>To directly extract the Rayleigh wave parameters, we can access them in the following way (here we extract the
Rayleigh wave propagation azimuth). With the corresponding time and frequency vectors.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">azi_rayleigh</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">wave_parameters</span><span class="p">[</span><span class="s2">&quot;R&quot;</span><span class="p">][</span><span class="s2">&quot;phi&quot;</span><span class="p">]</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">f_pol</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">t_pol</span>
</pre></div>
</div>
<p>You can either plot the estimated parameters yourself or make use of the implemented plotting routines, where lh_min
and lh_max determine the estimator power range for which the parameters are plotted. For the ‘DOT’ method that we used
here, this corresponds to a simple likelihood, meaning that we only want to plot the results at time-frequency pixels
where the Rayleigh wave model fits the data with a likelihoood larger than 0.7.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">analysis</span><span class="o">.</span><span class="n">plot_wave_parameters</span><span class="p">(</span><span class="n">estimator_configuration</span><span class="o">=</span><span class="n">est</span><span class="p">,</span> <span class="n">lh_min</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">lh_max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_alaska_wave_parameter_estimation_001.png" srcset="../_images/sphx_glr_alaska_wave_parameter_estimation_001.png" alt="Rayleigh-wave model fit, Rayleigh-wave phase velocity, Propagation Azimuth, Ellipticity angle" class = "sphx-glr-single-img"/><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  19.133 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-alaska-wave-parameter-estimation-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/cd5cdcfc9e51f6ca845118e542843497/alaska_wave_parameter_estimation.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">alaska_wave_parameter_estimation.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/892f38a9e78ea36ad99ec854403e4aef/alaska_wave_parameter_estimation.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">alaska_wave_parameter_estimation.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="ml_wave_type_estimation.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">6-C Polarization Analysis: Wave type classification</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="beamforming.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Array Processing: Beamforming</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
        &copy; Copyright 2022, The TwistPy Developers.<br/>
      Last updated on Dec 08, 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>